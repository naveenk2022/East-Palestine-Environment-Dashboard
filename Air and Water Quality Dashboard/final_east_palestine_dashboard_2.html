<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mapping the Impact of the Train Derailment in East Palestine, Ohio on AQI values in Ohio, West Virginia, and Pennsylvania.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="final_east_palestine_dashboard_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_east_palestine_dashboard_2_files/libs/quarto-html/quarto.js"></script>
<script src="final_east_palestine_dashboard_2_files/libs/quarto-html/popper.min.js"></script>
<script src="final_east_palestine_dashboard_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_east_palestine_dashboard_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_east_palestine_dashboard_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_east_palestine_dashboard_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_east_palestine_dashboard_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_east_palestine_dashboard_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_east_palestine_dashboard_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div class="page-layout-custom">  

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mapping the Impact of the Train Derailment in East Palestine, Ohio on AQI values in Ohio, West Virginia, and Pennsylvania.</h1>
<p class="subtitle lead">Using AirNow’s daily PM2.5 and Ozone data for the months of January and February, 2023, for zip codes within 30 miles of the train derailment site.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="panel-grid layout-sidebar ms-md-0 layout-sidebar-left">
<div class="cell panel-sidebar card bg-light p-2 g-col-24 g-col-lg-7">
<div class="cell-output-display no-overflow-x">
<div class="col-sm-4">
<form class="well" role="complementary">
<p>The train derailment occurred on February 3rd, 2023.</p>
<div class="form-group shiny-input-container">
<label class="control-label" id="date-label" for="date">Select a date:</label>
<input class="js-range-slider" id="date" data-skin="shiny" data-min="1672531200000" data-max="1677542400000" data-from="1672531200000" data-step="86400000" data-grid="true" data-grid-num="9.66666666666667" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="date" data-time-format="%F">
<div class="slider-animate-container">
<a href="#" class="slider-animate-button" data-target-id="date" data-interval="1000" data-loop="FALSE">
<span class="play">
<i aria-label="play icon" class="glyphicon glyphicon-play" role="presentation"></i>
</span>
<span class="pause">
<i aria-label="pause icon" class="glyphicon glyphicon-pause" role="presentation"></i>
</span>
</a>
</div>
</div>
<br>
<div class="form-group shiny-input-container">
<label class="control-label" id="data_type-label" for="data_type">Select data type:</label>
<div>
<select id="data_type"><option value="USGS Water Quality Metrics" selected="">USGS Water Quality Metrics</option>
<option value="AirNow AQI">AirNow AQI</option></select>
<script type="application/json" data-for="data_type" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
<br>
<div data-display-if="input.data_type == 'AirNow AQI'" data-ns-prefix="">
<p>The US AQI (Air Quality Index) is the EPA's Index for reporting Air Quality. AQI is a value that ranges from 0 to 500.</p>
<br>
<p>The Clean Air Act (the law that defines EPA’s responsibilities for protecting and improving the nation’s air quality), requires the EPA to set National Ambient Air Quality Standards (NAAQS) for six common air pollutants (also known as “Criteria Air Pollutants”).</p>
<br>
<p>
<a href="https://www.airnow.gov/about-airnow/">AirNow</a>
is a partnership of the U.S. Environmental Protection Agency, National Oceanic and Atmospheric Administration (NOAA), National Park Service, NASA, Centers for Disease Control, and tribal, state, and local air quality agencies. AirNow’s Historical Observation by Zip Code tool was used to obtain the daily AQI value for the zip codes within 30 miles of the train derailment, over the months of January and February, 2023.
</p>
<br>
<p>AirNow provides the AQI for two pollutants: PM2.5 and Ozone.</p>
</div>
<div data-display-if="input.data_type == 'USGS Water Quality Metrics'" data-ns-prefix="">
<p>The WQI (Water Quality Index) model is a tool that is based on aggregating a conglomerate of several water quality parameters in order to provide a single value that indicates the overall water quality of a waterbody, even in the context of spatially and temporally different datasets being used.</p>
<br>
<div class="form-group shiny-input-container">
<label class="control-label" id="usgs_site_id-label" for="usgs_site_id">The following three sites are the USGS sites closest to the train derailment location.</label>
<div>
<select id="usgs_site_id"><option value="03099500" selected="">03099500</option>
<option value="03098600">03098600</option>
<option value="411402080492400">411402080492400</option></select>
<script type="application/json" data-for="usgs_site_id" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
<br>
<p>Using the USGS’s(United States Geological Survey) National Water Information System’s web interface, queries were run to return daily data for the top five of the above described metrics for the months of January and February, 2023. However, the queries returned data only on the pH and dissolved Oxygen values for the time period and States specified, with no data being present for the other metrics.</p>
</div>
</form>
</div>
</div>
</div>
<div class="panel-fill panel-grid g-col-24 g-col-lg-17 pt-3 pt-lg-0">
<div class="g-col-24">
<div class="cell panel-fill">
<div class="cell-output-display">
<div class="col-sm-8" role="main">
<div class="tabbable">
<ul class="nav nav-tabs shiny-tab-input" id="pills" data-tabsetid="2494">
<li class="active">
<a href="#tab-2494-1" data-toggle="tab" data-bs-toggle="tab" data-value="| AirNow PM2.5 data |">| AirNow PM2.5 data |</a>
</li>
<li>
<a href="#tab-2494-2" data-toggle="tab" data-bs-toggle="tab" data-value="| AirNow Ozone data |">| AirNow Ozone data |</a>
</li>
<li>
<a href="#tab-2494-3" data-toggle="tab" data-bs-toggle="tab" data-value="| USGS Dissolved Oxygen data |">| USGS Dissolved Oxygen data |</a>
</li>
<li>
<a href="#tab-2494-4" data-toggle="tab" data-bs-toggle="tab" data-value="| USGS pH data |">| USGS pH data |</a>
</li>
</ul>
<div class="tab-content" data-tabsetid="2494">
<div class="tab-pane active" data-value="| AirNow PM2.5 data |" id="tab-2494-1">
<div class="leaflet html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="pm25_plot" style="width:100%;height:400px;"></div>
<div class="shiny-plot-output html-fill-item" id="pm25_chart" style="width:100%;height:400px;"></div>
</div>
<div class="tab-pane" data-value="| AirNow Ozone data |" id="tab-2494-2">
<div class="leaflet html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="ozone_plot" style="width:100%;height:400px;"></div>
<div class="shiny-plot-output html-fill-item" id="ozone_chart" style="width:100%;height:400px;"></div>
</div>
<div class="tab-pane" data-value="| USGS Dissolved Oxygen data |" id="tab-2494-3">
<div class="shiny-plot-output html-fill-item" id="usgs_o2" style="width:800px;height:600px;"></div>
<div class="shiny-plot-output html-fill-item" id="usgs_o2_chart" style="width:100%;height:400px;"></div>
</div>
<div class="tab-pane" data-value="| USGS pH data |" id="tab-2494-4">
<div class="shiny-plot-output html-fill-item" id="usgs_ph" style="width:800px;height:600px;"></div>
<div class="shiny-plot-output html-fill-item" id="usgs_ph_chart" style="width:100%;height:400px;"></div>
</div>
</div>
</div>
<p>On the 3rd of February, 2023, 51 cars of a freight train operated by Norfolk Southern derailed in East Palestine, Ohio at 8.55pm EST. Five of these cars were carrying vinyl chloride. On February 5th, the tanker cars had their contents released into a trough, which was then ignited, creating a large plume above East Palestine. Residents within a mile of the controlled burn were ordered to evacuate.</p>
<br>
<p>Norfolk Southern reported that the hazardous chemicals on the train consisted of vinyl chloride, combustible liquids, butyl acrylate and benzene residue cars.A report from the EPA was then sent to Norfolk Southern, stating that glycol monobutyl ether, ethylhexyl acrylate and isobutylene we also found in the train cars that were derailed.</p>
<br>
<p>The evacuation was lifted on February 9 after the EPA reported that the air inside and outside the evacuation zone had returned to normal levels. A report released by the Ohio Department of Natural Resources stated that the estimated final sample count of aquatic species killed in waterways impacted in the area totaled 2,938. ODNR also estimated the total number of other aquatic life killed as a result of the derailment, including small fish, crayfish, amphibians, and macroinvertebrates. This number is approximately 5,500. The EPA administrator Michael Regan issued an advisory to stay out of potentially contaminated streams and creeks on March 1st.</p>
<br>
<p>Sources:</p>
<a href="https://apnews.com/article/ohio-train-derailment-updates-bf5a60de2243cd6f7f730096aa33294c">Patrick Orsagos, John Seewer. 2023. “Crews Release Toxic Chemicals from Derailed Tankers in Ohio.” AP News, February.</a>
<br>
<a href="https://www.wfmj.com/story/48313434/norfolk-southern-releases-list-of-chemicals-carried-by-derailed-train">Sydney Stalnecker. 2023. “Norfolk Southern Releases List of Chemicals Carried by Derailed Train.” 21 WFMJ, February.</a>
<br>
<a href="https://ohiodnr.gov/discover-and-learn/safety-conservation/about-ODNR/news/Train-Derailment">ODNR Update on East Palestine Train Derailment Impact to Wildlife, 2023. Columbus, Ohio.</a>
<br>
<a href="https://www.wkbn.com/news/local-news/east-palestine-train-derailment/3-additional-chemicals-discovered-on-east-palestine-train-derailment/">Jennifer Rodriguez. 2023. “‘We Basically Nuked a Town’: 3 More Chemicals Discovered in Ohio Train Derailment.” WKBN 27, February.</a>
<br>
<a href="https://www.foxnews.com/politics/epa-director-advises-east-palestine-children-stay-out-creeks-streams-ohio-train-derailment-fallout">Danielle Wallace. 2023. “EPA Director Advises East Palestine Children to Stay Out of Creeks, Streams Amid Ohio Train Derailment Fallout,” March.</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-context="server">

</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(sf)
library(shiny)
library(glue)
library(plotly)
library(RColorBrewer)
library(leaflet)
library(spatstat)
library(patchwork)
library(SpatialKDE)
library(tidyverse)
theme_set(theme_bw())
</script>
 
<script type="application/shiny-prerendered" data-context="server">
initial_lat = 40.84
initial_lng = -80.54
initial_zoom = 8.5
output$pm25_plot <- renderLeaflet({
  pm25_polygon <- pm25_data |> 
    filter(DateObserv == input$date)
  pm25_polygon <- pm25_polygon |> sf::st_transform('+proj=longlat +datum=WGS84')
  labels <- sprintf(
  "<strong>%s<\u002fstrong><br/>%s - AQI value",
  pm25_polygon$Zipcode, pm25_polygon$AQI
  ) %>% lapply(htmltools::HTML)
  bins <- c(10,22,34,46,58,70,82, Inf)
  pal <- colorBin("YlOrRd", domain = pm25_polygon$AQI, bins = bins)
  leaflet() |>
    setView(lat = initial_lat, lng = initial_lng, zoom = initial_zoom) |>
    addProviderTiles(providers$CartoDB.Positron) |>
    addPolygons(data = pm25_polygon,
                fillColor = ~pal(pm25_polygon$AQI),
                weight = 2,
                opacity = 1,
                color = "white",
                dashArray = "3",
                fillOpacity = 0.7,
                highlightOptions = highlightOptions(
                  weight = 5,
                  color = "#666",
                  dashArray = "",
                  fillOpacity = 0.7,
                  bringToFront = TRUE),
                label = labels,
                layerId = ~Zipcode, 
                labelOptions = labelOptions(
                  style = list("font-weight" = "normal", padding = "3px 8px"),
                  textsize = "15px",
                  direction = "auto")) |>
    addLegend(pal = pal, values = pm25_polygon$AQI, 
              opacity = 0.7, 
              title = "PM2.5 AQI Values",
              position = "bottomright") |>
    addMarkers(data = derail_site,
               label = "Derailment Site")
    
  

  })


# Define a reactiveValues object to store the clicked_zip value
values <- reactiveValues(clicked_zip = "")

# Update the clicked_zip value when a polygon is clicked
observeEvent(input$pm25_plot_shape_click, {
  click <- input$pm25_plot_shape_click
  if (is.null(click))
    return()
  values$clicked_zip <- click$id
})

# Use the clicked_zip value in the renderPlot function
output$pm25_chart <- renderPlot({
  clicked_zip <- values$clicked_zip
  pm25_polygon <- pm25_data %>% 
    filter(Zipcode == clicked_zip)
  # Check if pm25_polygon has any rows
  if (nrow(pm25_polygon) == 0) {
    return(NULL)
  }
  ggplot(data = pm25_polygon, aes(x = DateObserv, y = AQI,group = 1)) +
    geom_line(color = "#00AFBB", linewidth = 0.5)  +
    geom_point() + 
    geom_text(aes(label = AQI), nudge_y = 1, nudge_x = 0.5) +
    labs(title = str_wrap(glue("A Time Series Plot showing the daily PM2.5 AQI values for the months of January and February at the {clicked_zip} Zipcode.")
                          , width = 70),
         subtitle = "The dashed red line is the day of the train derailment. The dashed blue line is the selected date. The dashed green line is the mean AQI over the time period of study.",
         x = "Date Observed",
         y = "AQI Value") +
    theme(axis.text.x = element_text(angle=45, vjust=.5, hjust=0.5)) +
    geom_vline(xintercept =("2023-02-03"),linetype = "dashed", colour = "red") +
    geom_vline(xintercept = (format(input$date, "%Y-%m-%d")),linetype = "dashed", colour = "blue") +
    geom_hline(yintercept = pm_mean_AQI, linetype = "dashed", colour = "green")
})

    
output$ozone_plot <- renderLeaflet({
  ozone_polygon <- ozone_data |> 
    filter(DateObserv == input$date)
  ozone_polygon <- ozone_polygon |> sf::st_transform('+proj=longlat +datum=WGS84')
  labels <- sprintf(
  "<strong>%s<\u002fstrong><br/>%s - AQI value<sup>2<\u002fsup>",
  ozone_polygon$Zipcode, ozone_polygon$AQI
  ) %>% lapply(htmltools::HTML)
  bins <- c(14, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, Inf)
  pal <- colorBin("YlOrRd", domain = ozone_polygon$AQI, bins = bins)
  leaflet() |>
    setView(lat = initial_lat, lng = initial_lng, zoom = initial_zoom) |>
    addProviderTiles(providers$CartoDB.Positron) |>
    addPolygons(data = ozone_polygon,
                fillColor = ~pal(ozone_polygon$AQI),
                weight = 2,
                opacity = 1,
                color = "white",
                dashArray = "3",
                fillOpacity = 0.7,
                highlightOptions = highlightOptions(
                  weight = 5,
                  color = "#666",
                  dashArray = "",
                  fillOpacity = 0.7,
                  bringToFront = TRUE),
                label = labels,
                layerId = ~Zipcode,
                labelOptions = labelOptions(
                  style = list("font-weight" = "normal", padding = "3px 8px"),
                  textsize = "15px",
                  direction = "auto")) |>
    addLegend(pal = pal, values = ozone_polygon$AQI, opacity = 0.7, title = "Ozone AQI Values",
  position = "bottomright") |>
    addMarkers(data = derail_site,
               label = "Derailment Site")
    
  

  })

# Define a reactiveValues object to store the clicked_zip value
values <- reactiveValues(clicked_zip = "")

# Update the clicked_zip value when a polygon is clicked
observeEvent(input$ozone_plot_shape_click, {
  click <- input$ozone_plot_shape_click
  if (is.null(click))
    return()
  values$clicked_zip <- click$id
})

# Use the clicked_zip value in the renderPlot function
output$ozone_chart <- renderPlot({
  clicked_zip <- values$clicked_zip
  ozone_polygon <- ozone_data %>% 
    filter(Zipcode == clicked_zip)
  ggplot(data = ozone_polygon, aes(x = DateObserv, y = AQI,group = 1)) +
    geom_line(color = "#00AFBB", linewidth = 0.5)  +
    geom_point() + 
    geom_text(aes(label = AQI), nudge_y = 1, nudge_x = 0.5) +
    labs(title = str_wrap(glue("A Time Series Plot showing the daily Ozone AQI values for the months of January and February at the {clicked_zip} Zipcode.")
                          , width = 70),
         subtitle = "The dashed red line is the day of the train derailment. The dashed blue line is the selected date.The dashed green line is the mean AQI over the time period of study.",
         x = "Date Observed",
         y = "AQI Value") +
    theme(axis.text.x = element_text(angle=45, vjust=.5, hjust=0.5)) +
    geom_vline(xintercept =("2023-02-03"),linetype = "dashed", colour = "red") +
    geom_vline(xintercept = (format(input$date, "%Y-%m-%d")),linetype = "dashed", colour = "blue") +
    geom_hline(yintercept = o3_mean_AQI, linetype = "dashed", colour = "green")
})

# Creating the USGS pH quality plots
output$usgs_ph <- renderPlot({
  oh_site_data <- oh_site_data |>
    filter(date == input$date)
  pa_site_data <- pa_site_data |>
    filter(date == input$date)
  wv_site_data <- wv_site_data |>
    filter(date == input$date)
  input_date = input$date
  oh_site_data <- oh_site_data |>
    select(ph_max, geometry) |>
    mutate(ph_max = as.double(ph_max)) |>
    filter(complete.cases(ph_max))
  pa_site_data <- pa_site_data |>
    select(ph_max, geometry) |>
    mutate(ph_max = as.double(ph_max))|>
    filter(complete.cases(ph_max))
  wv_site_data <- wv_site_data |>
    select(ph_max, geometry) |>
    mutate(ph_max = as.double(ph_max))|>
    filter(complete.cases(ph_max))
  all_site_data <- rbind(oh_site_data, pa_site_data, wv_site_data)
  kde_all <- kde(points = all_site_data, band_width = 70000, 
                 decay = 1, kernel = "quartic", 
                 scaled = FALSE, weights = all_site_data$ph_max,
                 grid = all_state_grid, cell_size = 500, quiet = FALSE)
  
  ggplot() +
    geom_sf(data = kde_all, aes(fill = kde_value)) +
    geom_sf(data = oh_water, col = "blue") +
    geom_sf(data = pa_water, col = "blue") +
    geom_sf(data = wv_water, col = "blue") +
    geom_sf(data = all_site_data, col = "black") +
    scale_fill_gradient(low = "#fee5d9", high = "#a50f15") +
    geom_sf(data = all_state, fill = "transparent", col = "#00441b", size = 100000) +
    labs(title = str_wrap("Mapping the pH of Water Bodies of Ohio, Pennsylvania and West Virginia across the months of January and February, 2023.",
                          width = 90),
         fill = "KDE Value",
         subtitle = "Data Obtained from USGS. ") +
    theme_bw()
  
})

# Creating the USGS O2 quality plots
output$usgs_o2 <- renderPlot({
  oh_site_data <- oh_site_data |>
    filter(date == input$date)
  pa_site_data <- pa_site_data |>
    filter(date == input$date)
  wv_site_data <- wv_site_data |>
    filter(date == input$date)
  input_date = input$date
  oh_site_data <- oh_site_data |>
    select(O2_max, geometry) |>
    mutate(O2_max = as.double(O2_max)) |>
    filter(complete.cases(O2_max))
  pa_site_data <- pa_site_data |>
    select(O2_max, geometry) |>
    mutate(O2_max = as.double(O2_max))|>
    filter(complete.cases(O2_max))
  wv_site_data <- wv_site_data |>
    select(O2_max, geometry) |>
    mutate(O2_max = as.double(O2_max))|>
    filter(complete.cases(O2_max))
  all_site_data <- rbind(oh_site_data, pa_site_data, wv_site_data)
  kde_all <- kde(points = all_site_data, band_width = 70000, 
                 decay = 1, kernel = "quartic", 
                 scaled = FALSE, weights = all_site_data$O2_max,
                 grid = all_state_grid, cell_size = 500, quiet = FALSE)
  
  ggplot() +
    geom_sf(data = kde_all, aes(fill = kde_value)) +
    geom_sf(data = oh_water, col = "blue") +
    geom_sf(data = pa_water, col = "blue") +
    geom_sf(data = wv_water, col = "blue") +
    geom_sf(data = all_site_data, col = "black") +
    scale_fill_gradient(low = "#fee5d9", high = "#a50f15") +
    geom_sf(data = all_state, fill = "transparent", col = "#00441b", size = 100000) +
    labs(title = str_wrap("Mapping the dissolved Oxygen of Water Bodies of Ohio, Pennsylvania and West Virginia across the months of January and February, 2023.",
                          width = 90),
         fill = "KDE Value",
         subtitle = "Data Obtained from USGS. ") +
    theme_bw()
  
})

output$usgs_o2_chart <- renderPlot({
  input_site <- input$usgs_site_id
  all_site_data <- all_site_data |>
    filter(site_id == input_site)
  ggplot(data = all_site_data, aes(x = date, y = O2_max,group = 1)) +
    geom_line(color = "#00AFBB", linewidth = 0.5)  +
    geom_point() + 
    geom_text(aes(label = O2_max), nudge_y = 1, nudge_x = 0.5) +
    labs(title = glue("A Time Series Plot showing the daily dissolved Oxygen level for the months of January and February at the {input_site} site."),
         subtitle = "The dashed red line is the day of the train derailment. The dashed blue line is the selected date.",
         x = "Date Observed",
         y = "Maximum Dissolved Oxygen Level observed") +
    theme(axis.text.x = element_text(angle=45, vjust=.5, hjust=0.5))+
    geom_vline(xintercept =("2023-02-03"),linetype = "dashed", colour = "red") +
    geom_vline(xintercept = (format(input$date, "%Y-%m-%d")),linetype = "dashed", colour = "blue") 
})

output$usgs_ph_chart <- renderPlot({
  input_site <- input$usgs_site_id
  all_site_data <- all_site_data |>
    filter(site_id == input_site)
  ggplot(data = all_site_data, aes(x = date, y = ph_max,group = 1)) +
    geom_line(color = "#00AFBB", linewidth = 0.5)  +
    geom_point() + 
    geom_text(aes(label = ph_max), nudge_y = 1, nudge_x = 0.5) +
    labs(title = glue("A Time Series Plot showing the daily water pH level for the months of January and February at the {input_site} site."),
         subtitle = "The dashed red line is the day of the train derailment. The dashed blue line is the selected date.",
         x = "Date Observed",
         y = "Maximum water pH level observed") +
    theme(axis.text.x = element_text(angle=45, vjust=.5, hjust=0.5))+
    geom_vline(xintercept =("2023-02-03"),linetype = "dashed", colour = "red") +
    geom_vline(xintercept = (format(input$date, "%Y-%m-%d")),linetype = "dashed", colour = "blue") 
})

</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"character","attributes":{},"value":["leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leafletfix"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leafletfix"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leafletfix.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["proj4"]},{"type":"character","attributes":{},"value":["2.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["Proj4Leaflet"]},{"type":"character","attributes":{},"value":["1.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["rstudio_leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/rstudio_leaflet"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rstudio_leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.1.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet-binding"]},{"type":"character","attributes":{},"value":["2.1.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.1.2"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108]}},"value":[{"type":"character","attributes":{},"value":["abind","base","bslib","cachem","class","classInt","cli","codetools","colorspace","compiler","crosstalk","data.table","datasets","DBI","deldir","digest","dplyr","e1071","ellipsis","evaluate","fansi","fastmap","forcats","generics","ggplot2","glue","goftest","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","KernSmooth","knitr","later","lattice","lazyeval","leaflet","lifecycle","lubridate","magrittr","Matrix","memoise","methods","mgcv","mime","munsell","nlme","patchwork","pillar","pkgconfig","plotly","polyclip","promises","proxy","purrr","R6","raster","RColorBrewer","Rcpp","readr","rlang","rmarkdown","rpart","rstudioapi","sass","scales","sf","shiny","sp","SpatialKDE","spatstat","spatstat.data","spatstat.explore","spatstat.geom","spatstat.linnet","spatstat.model","spatstat.random","spatstat.sparse","spatstat.utils","splines","stats","stringi","stringr","tensor","terra","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","units","utf8","utils","vctrs","viridisLite","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4-5","4.2.3","0.4.2","1.0.7","7.3-21","0.4-9","3.6.0","0.2-19","2.1-0","4.2.3","1.2.0","1.14.8","4.2.3","1.1.3","1.0-6","0.6.31","1.1.0","1.7-13","0.3.2","0.20","1.0.4","1.1.1","1.0.0","0.1.3","3.4.1","1.6.2","1.2-3","4.2.3","4.2.3","4.2.3","0.3.3","1.1.3","0.5.4","1.6.2","1.6.9","1.4.5","0.1.4","1.8.4","2.23-20","1.42","1.3.0","0.20-45","0.2.2","2.1.2","1.0.3","1.9.2","2.0.3","1.5-3","2.0.1","4.2.3","1.8-42","0.12","0.5.0","3.1-162","1.1.2","1.9.0","2.0.3","4.10.1","1.10-4","1.2.0.1","0.4-27","1.0.1","2.5.1","3.6-20","1.1-3","1.0.10","2.1.4","1.1.0","2.20","4.1.19","0.14","0.4.5","1.2.1","1.0-12","1.7.4","1.6-0","0.8.2","3.0-3","3.0-1","3.1-0","3.1-0","3.0-6","3.2-1","3.1-4","3.0-1","3.0-2","4.2.3","4.2.3","1.7.12","1.5.0","1.5","1.7-18","3.2.0","1.3.0","1.2.0","2.0.0","0.2.0","4.2.3","0.3.0","0.8-1","1.2.3","4.2.3","0.6.0","0.4.1","2.5.0","0.37","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /container fluid -->



</body></html>